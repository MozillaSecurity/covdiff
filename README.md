covdiff
==========
Compare coverage reports

[![Task Status][task-badge]][task]
[![codecov][codecov-badge]][codecov]
[![black][black-badge]][black]
[![MPLv2][license-badge]][license]

[task-badge]: https://community-tc.services.mozilla.com/api/github/v1/repository/MozillaSecurity/covdiff/master/badge.svg
[task]: https://community-tc.services.mozilla.com/api/github/v1/repository/MozillaSecurity/covdiff/master/latest
[codecov-badge]: https://codecov.io/gh/MozillaSecurity/covdiff/branch/master/graph/badge.svg
[codecov]: https://codecov.io/gh/MozillaSecurity/covdiff
[black-badge]: https://img.shields.io/badge/code%20style-black-000000.svg
[black]: https://github.com/psf/black
[license-badge]: https://img.shields.io/badge/License-MPL%202.0-blue.svg
[license]: LICENSE

Overview
-----------
Covdiff is primarily used to compare coverage reports generated by the fuzzing team and Mozilla CI.

Usage
-----------
```bash
usage: __main__.py [-h] [-f FILE] reports reports dest

Compare two coverage reports

positional arguments:
  reports                 Reports to compare
  dest                    Path to store results

optional arguments:
  -h, --help              show this help message and exit
  -f FILE, --filter FILE  Path to filter list
```

Where to get reports?
-----------
```bash
# Fetch a coverage report from a fuzzmanager instance
wget https://fuzzmanager/covmanager/collections/1234/download/ -O fuzzing.json

# Fetch a coverage report from CI
# Replace `{REVISION}` or use `latest`
wget https://firefox-ci-tc.services.mozilla.com/api/index/v1/task/project.relman.code-coverage.production.repo.mozilla-central.{REVISION}/artifacts/public/code-coverage-report.json -O ci.json
```

Contributing
-----------
This project includes numerous pre-commit hooks. Before committing, please make sure that these hooks are installed.

```bash
pre-commit install
```